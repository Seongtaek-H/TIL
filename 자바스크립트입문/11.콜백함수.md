## 비동기 처리의 시작, 콜백 이해하기

*  JavaScript is synchronous.

* Exccute the code block in order after hoisting.

* hoisting : var, function decalration 이 제일 위로 올라가는 것



* synchronous : 동기적으로 코드가 순서대로 실행되는 것

* asynchronous : 비동기적으로 언제 코드가 실행될지 예측할 수 없는 것

* callback : 다른 함수의 인자로써, 당장 실행되지 않고 그 함수가 실행될 때 호출되어지는 함수

```js
console.log('1'); // 동기
setTimeout(() => console.log('4'),1000); // 비동기
console.log('2'); // 동기
console.log('3'); // 동기

// Synchronous callback
function printImmediately(print) {
    print();
}
printImmediately(()=>console.log('hello'));

// Asynchronous callback
function printWithDelay(print, timeout){
    setTimeout(print,timeout);
}
printWithDelay(()=>console.log('async callback'),2000);
```



* 콜백을 너무 남발하면 가독성이 떨어지고, 에러가 발생해서 디버깅할 때에도 굉장히 어려움

```js
// Callback Hell example
console.clear();
class UserStorage {
    loginUser(id, password, onSuccess, onError) {
        setTimeout(() => {
        if (
            (id === 'ellie' && password === 'dream') ||
            (id === 'coder' && password === 'academy')
            ) 
        {
            onSuccess(id);
        } else {
            onError(new Error('not found'));
        }
        }, 2000);
    }

    getRoles(user, onSuccess, onError) {
        setTimeout(() => {
        if (user === 'ellie') {
            onSuccess({ name: 'ellie', role: 'admin' });
        } else {
            onError(new Error('no access'));
        }
        }, 1000);
    }
}

const userStorage = new UserStorage();
const id = prompt('enter ur id');
const password = prompt('enter ur pw');
userStorage.loginUser(
    id,
    password,
    user => {
        userStorage.getRoles(
            user,
            userWithRole=>{
                alert(`hello ${userWithRole.name}, you have a ${userWithRole.role}`);
            },
            error => {console.log(error);});
    },
    error => {console.log(error);}
);
```

